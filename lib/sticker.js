const _0x52d55c=_0x28fb;(function(_0x571f62,_0x3ce6de){const _0x1d600e=_0x28fb,_0x15a2e7=_0x571f62();while(!![]){try{const _0x3f181e=-parseInt(_0x1d600e(0x8d))/0x1+parseInt(_0x1d600e(0x8e))/0x2+parseInt(_0x1d600e(0x8f))/0x3+parseInt(_0x1d600e(0x90))/0x4*(parseInt(_0x1d600e(0x91))/0x5)+parseInt(_0x1d600e(0x92))/0x6*(parseInt(_0x1d600e(0x93))/0x7)+parseInt(_0x1d600e(0x94))/0x8*(-parseInt(_0x1d600e(0x95))/0x9)+parseInt(_0x1d600e(0x96))/0xa*(-parseInt(_0x1d600e(0x97))/0xb);if(_0x3f181e===_0x3ce6de)break;else _0x15a2e7['push'](_0x15a2e7['shift']());}catch(_0x174b37){_0x15a2e7['push'](_0x15a2e7['shift']());}}}(_0x5187,0x4f91a));import{dirname}from'path';import{fileURLToPath}from'url';import*as _0x398a3c from'fs';import*as _0x1abbe6 from'path';import*as _0x376529 from'crypto';import{ffmpeg}from'./converter.js';import _0x12fcf6 from'fluent-ffmpeg';import{spawn}from'child_process';import _0xfe49f1 from'./uploadFile.js';import _0x44c1ba from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';import _0xfacafd from'node-webpmux';import _0x531e8c from'node-fetch';const __dirname=dirname(fileURLToPath(import.meta[_0x52d55c(0x98)])),tmp=_0x1abbe6[_0x52d55c(0x99)](__dirname,_0x52d55c(0x9a));function sticker2(_0x1702e4,_0x2aa2c3){return new Promise(async(_0x45d359,_0xa1ff1)=>{const _0x1a6e30=_0x28fb;try{if(_0x2aa2c3){let _0xdf196=await _0x531e8c(_0x2aa2c3);if(_0xdf196['status']!==0xc8)throw await _0xdf196[_0x1a6e30(0x9b)]();_0x1702e4=await _0xdf196['buffer']();}let _0xaf48a6=_0x1abbe6['join'](tmp,+new Date()+_0x1a6e30(0x9c));await _0x398a3c[_0x1a6e30(0x9d)][_0x1a6e30(0x9e)](_0xaf48a6,_0x1702e4);let _0x1ada8d=spawn('ffmpeg',['-y','-i',_0xaf48a6,'-vf','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','-f',_0x1a6e30(0x9f),'-']);_0x1ada8d['on'](_0x1a6e30(0xa0),_0xa1ff1),_0x1ada8d['on'](_0x1a6e30(0xa1),async()=>{const _0x5776c9=_0x1a6e30;await _0x398a3c[_0x5776c9(0x9d)][_0x5776c9(0xa2)](_0xaf48a6);});let _0xb7c32b=[];const [_0x3ea6be,..._0x5e0260]=[...module[_0x1a6e30(0xa3)][_0x1a6e30(0xa4)]['gm']?['gm']:module[_0x1a6e30(0xa3)][_0x1a6e30(0xa5)]?[_0x1a6e30(0xa5)]:[],_0x1a6e30(0xa6),_0x1a6e30(0xa7),'webp:-'];let _0x4dd8d9=spawn(_0x3ea6be,_0x5e0260);_0x4dd8d9['on'](_0x1a6e30(0xa0),_0x4fdecf=>conn['reply'](m['chat'],util[_0x1a6e30(0xa8)](_0x4fdecf),m)),_0x4dd8d9['stdout']['on'](_0x1a6e30(0xa9),_0x56c057=>_0xb7c32b[_0x1a6e30(0xaa)](_0x56c057)),_0x1ada8d[_0x1a6e30(0xab)][_0x1a6e30(0xac)](_0x4dd8d9[_0x1a6e30(0xad)]),_0x4dd8d9['on'](_0x1a6e30(0xae),()=>{_0x45d359(Buffer['concat'](_0xb7c32b));});}catch(_0x103eae){_0xa1ff1(_0x103eae);}});}function _0x28fb(_0x54a93d,_0x4460f3){const _0x51876e=_0x5187();return _0x28fb=function(_0x28fb25,_0x34030e){_0x28fb25=_0x28fb25-0x8d;let _0x33c83b=_0x51876e[_0x28fb25];return _0x33c83b;},_0x28fb(_0x54a93d,_0x4460f3);}async function sticker3(_0x4e7f36,_0x3986ba,_0x20d35f,_0x154033){const _0x6616a6=_0x52d55c;_0x3986ba=_0x3986ba?_0x3986ba:await _0xfe49f1(_0x4e7f36);let _0x260448=await _0x531e8c(_0x6616a6(0xaf)+new URLSearchParams(Object[_0x6616a6(0xb0)]({'url':_0x3986ba,'packname':_0x20d35f,'author':_0x154033})));return await _0x260448[_0x6616a6(0xb1)]();}function _0x5187(){const _0x1c5357=['push','stdout','pipe','stdin','exit','https://api.xteam.xyz/sticker/wm?','entries','buffer','status','-vf','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','jpeg','default','toBuffer','application/octet-stream','bin','../tmp/','ext','.webp','mime','inputFormat','end','addOutputOptions','-vcodec','webp','save','Image','randomBytes','toString','hex','from','stringify','concat','writeUIntLE','load','exif','ffmpeg','ffmpegWebp','filter','html','includes','423933WjDEtT','545974cbCtqk','455406YlcmdB','338416hdVrrR','20JQGHBj','18KmRVMx','527009VVfrYm','5232sEqLRu','1314eaxOVy','75650tGknke','209iGqFWE','url','join','../tmp','text','.jpeg','promises','writeFile','png','error','close','unlink','exports','support','magick','convert','png:-','format','data'];_0x5187=function(){return _0x1c5357;};return _0x5187();}async function sticker4(_0x563a39,_0x301099){const _0x547e3e=_0x52d55c;if(_0x301099){let _0x1ed386=await _0x531e8c(_0x301099);if(_0x1ed386[_0x547e3e(0xb2)]!==0xc8)throw await _0x1ed386[_0x547e3e(0x9b)]();_0x563a39=await _0x1ed386[_0x547e3e(0xb1)]();}return await ffmpeg(_0x563a39,[_0x547e3e(0xb3),_0x547e3e(0xb4)],_0x547e3e(0xb5),'webp');}async function sticker5(_0x4d1d7c,_0x162f01,_0x3a1021,_0x2564da,_0x111ade=[''],_0x3d3508={}){const _0x1b1716=_0x52d55c,{Sticker:_0xf5ee93}=await import('wa-sticker-formatter'),_0x47287d={'type':_0x1b1716(0xb6),'pack':_0x3a1021,'author':_0x2564da,'categories':_0x111ade,..._0x3d3508};return new _0xf5ee93(_0x4d1d7c?_0x4d1d7c:_0x162f01,_0x47287d)[_0x1b1716(0xb7)]();}function sticker6(_0x5b108e,_0x1c2eeb){return new Promise(async(_0x5dc9b6,_0x40a729)=>{const _0x21ddc0=_0x28fb;if(_0x1c2eeb){let _0x2c7263=await _0x531e8c(_0x1c2eeb);if(_0x2c7263['status']!==0xc8)throw await _0x2c7263[_0x21ddc0(0x9b)]();_0x5b108e=await _0x2c7263[_0x21ddc0(0xb1)]();}const _0x4384d8=await fileTypeFromBuffer(_0x5b108e)||{'mime':_0x21ddc0(0xb8),'ext':_0x21ddc0(0xb9)};if(_0x4384d8['ext']==_0x21ddc0(0xb9))_0x40a729(_0x5b108e);const _0x20af36=_0x1abbe6[_0x21ddc0(0x99)](__dirname,_0x21ddc0(0xba)+ +new Date()+'.'+_0x4384d8[_0x21ddc0(0xbb)]),_0x622f9b=_0x1abbe6[_0x21ddc0(0x99)](_0x20af36+_0x21ddc0(0xbc));await _0x398a3c[_0x21ddc0(0x9d)][_0x21ddc0(0x9e)](_0x20af36,_0x5b108e);let _0x185432=/video/i['test'](_0x4384d8[_0x21ddc0(0xbd)])?_0x12fcf6(_0x20af36)[_0x21ddc0(0xbe)](_0x4384d8[_0x21ddc0(0xbb)]):_0x12fcf6(_0x20af36)['input'](_0x20af36);_0x185432['on'](_0x21ddc0(0xa0),function(_0x37b742){const _0x5e7a9f=_0x21ddc0;console[_0x5e7a9f(0xa0)](_0x37b742),_0x398a3c[_0x5e7a9f(0x9d)][_0x5e7a9f(0xa2)](_0x20af36),_0x40a729(_0x5b108e);})['on'](_0x21ddc0(0xbf),async function(){const _0x26f63a=_0x21ddc0;_0x398a3c[_0x26f63a(0x9d)][_0x26f63a(0xa2)](_0x20af36),_0x5dc9b6(await _0x398a3c[_0x26f63a(0x9d)]['readFile'](_0x622f9b));})[_0x21ddc0(0xc0)]([_0x21ddc0(0xc1),'libwebp',_0x21ddc0(0xb3),'scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse'])['toFormat'](_0x21ddc0(0xc2))[_0x21ddc0(0xc3)](_0x622f9b);});}async function addExif(_0x16a90b,_0x1f1c34,_0x13724f,_0x22e68c=[''],_0x5b51f7={}){const _0x4c95b7=_0x52d55c,_0x501b14=new _0xfacafd[(_0x4c95b7(0xc4))](),_0x51d33f=_0x376529[_0x4c95b7(0xc5)](0x20)[_0x4c95b7(0xc6)](_0x4c95b7(0xc7)),_0x46178b={'sticker-pack-id':_0x51d33f,'sticker-pack-name':_0x1f1c34,'sticker-pack-publisher':_0x13724f,'emojis':_0x22e68c,..._0x5b51f7};let _0x22aae2=Buffer['from']([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x8483=Buffer[_0x4c95b7(0xc8)](JSON[_0x4c95b7(0xc9)](_0x46178b),'utf8'),_0x2ec8a5=Buffer[_0x4c95b7(0xca)]([_0x22aae2,_0x8483]);return _0x2ec8a5[_0x4c95b7(0xcb)](_0x8483['length'],0xe,0x4),await _0x501b14[_0x4c95b7(0xcc)](_0x16a90b),_0x501b14[_0x4c95b7(0xcd)]=_0x2ec8a5,await _0x501b14[_0x4c95b7(0xc3)](null);}async function sticker(_0x5be46d,_0x4a7f10,..._0x26fbba){const _0xf4d523=_0x52d55c;let _0x3c2ec2,_0x52a0cc;for(let _0x4fcf00 of[sticker3,global[_0xf4d523(0xa4)][_0xf4d523(0xce)]&&sticker6,sticker5,global[_0xf4d523(0xa4)][_0xf4d523(0xce)]&&global[_0xf4d523(0xa4)][_0xf4d523(0xcf)]&&sticker4,global[_0xf4d523(0xa4)]['ffmpeg']&&(global[_0xf4d523(0xa4)][_0xf4d523(0xa6)]||global[_0xf4d523(0xa4)][_0xf4d523(0xa5)]||global[_0xf4d523(0xa4)]['gm'])&&sticker2][_0xf4d523(0xd0)](_0x44f5da=>_0x44f5da)){try{_0x52a0cc=await _0x4fcf00(_0x5be46d,_0x4a7f10,..._0x26fbba);if(_0x52a0cc['includes'](_0xf4d523(0xd1)))continue;if(_0x52a0cc[_0xf4d523(0xd2)]('WEBP'))try{return await addExif(_0x52a0cc,..._0x26fbba);}catch(_0x355552){return console[_0xf4d523(0xa0)](_0x355552),_0x52a0cc;}throw _0x52a0cc[_0xf4d523(0xc6)]();}catch(_0xe70108){_0x3c2ec2=_0xe70108;continue;}}return console['error'](_0x3c2ec2),_0x3c2ec2;}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};export{sticker,sticker2,sticker3,sticker4,sticker6,addExif,support};